name: parity-secretstore-substrate
version: "0.1.0"
author: Parity Technologies <admin@parity.io>
about: Parity Secret Store for Substrate
args:
    - config:
        long: config
        value_name: CONFIG
        help: Path to configuration file.
        takes_value: true
    # Key server configuration options: general
    - self-secret:
        long: self-secret
        value_name: SELF_SECRET
        help: Hex-encoded secret key that is used to communicate with other key servers.
        takes_value: true
    - db-path:
        long: db-path
        value_name: DB_PATH
        help: Path to key server database where keys shares are stored. By default it points to "db" folder in current directory.
        takes_value: true
    - net-host:
        long: net-host
        value_name: NET_HOST
        help: Network interface that key server should use to communicate with other key servers. "0.0.0.0" by default.
        takes_value: true
    - net-port:
        long: net-port
        value_name: NET_PORT
        help: Network port (TCP) that key server should use to communicate with other key servers. 8083 by default.
        takes_value: true
    # Key server configuration options: related to key server set
    - key-servers:
        long: key-servers
        value_name: KEY_SERVERS
        help: Comma-separated list of other key servers identifiers (NODE_ADDRESS@NODE_NET_HOST:NODE_NET_PORT). If isn't specified (default), key servers set is read from Substrate node.
        takes_value: true
    - disable-auto-migration:
        long: disable-auto-migration
        help: Do not start auto migration session when key servers set changes. Only works when key servers set is read from the Substrate node.
        conflicts_with:
            - key-servers
    - admin:
        long: admin
        value_name: ADMIN
        help: Hex-encoded address of Secret Store administrator. Administrator may manually start migration sessions.
        takes_value: true
    # Substrate node connection options
    - sub-host:
        long: sub-host
        value_name: SUB_HOST
        help: Connect to Substrate node at given host. "localhost" by default.
        takes_value: true
    - sub-port:
        long: sub-port
        value_name: SUB_PORT
        help: Connect to Substrate node at given port. 9944 by default.
        takes_value: true
    - sub-signer:
        long: sub-signer
        value_name: SUB_SIGNER
        help: The SURI of secret key to use when transactions are submitted to the Substrate node. "//Alice" by default.
        takes_value: true
    - sub-signer-password:
        long: sub-signer-password
        value_name: SUB_SIGNER_PASSWORD
        help: The password for the SURI of secret key to use when transactions are submitted to the Substrate node. Empty by default.
        takes_value: true
    # On-chain service related options
    - on-chain-service:
        long: on-chain-service
        help: Enables the on-chain service on this key server. Only works with on-chain key servers set. Disabled by default.
    # HTTP service related options
    - http-service:
        long: http-service
        help: Enables the HTTP service on this key server. Disabled by default.
    - http-service-interface:
        long: http-service-interface
        value_name: HTTP_SERVICE_INTERFACE
        help: Expose HTTP API on given interface. "localhost" by default.
        takes_value: true
    - http-service-port:
        long: http-service-port
        value_name: HTTP_SERVICE_PORT
        help: Expose HTTP API on given port. 8082 by default.
        takes_value: true
    - http-service-cors:
        long: http-service-cors
        value_name: HTTP_SERVICE_CORS
        help: Specify CORS header for HTTP API responses. Special options are "all" and "none". "none" by default.
subcommands:
    - submit-transaction:
        about: Submit Substrate transaction.
        args:
            - sub-host:
                long: sub-host
                value_name: SUB_HOST
                help: Connect to Substrate node at given host. "localhost" by default.
                takes_value: true
            - sub-port:
                long: sub-port
                value_name: SUB_PORT
                help: Connect to Substrate node at given port. 9944 by default.
                takes_value: true
            - sub-signer:
                long: sub-signer
                value_name: SUB_SIGNER
                help: The SURI of secret key to use when transactions are submitted to the Substrate node. "//Alice" by default.
                takes_value: true
            - sub-signer-password:
                long: sub-signer-password
                value_name: SUB_SIGNER_PASSWORD
                help: The password for the SURI of secret key to use when transactions are submitted to the Substrate node. Empty by default.
                takes_value: true
            - transaction:
                long: transaction
                value_name: TRANSACTION
                help: Transaction to be submitted. Refer to SecretStoreTransaction enum for details.
                takes_value: true
                required: true
            - wait-mined:
                long: wait-mined
                help: Wait until transaction is included in the block.
            - wait-finalized:
                long: wait-finalized
                help: Wait until block with transaction is finalized. Assumes wait-mined.
            - wait-processed:
                long: wait-processed
                help: Wait until transaction is processed by SecretStore (if applicable). Assumes wait-finalized.
    - generate-key-pair:
        about: Generate key pair.
    - generate-document-key:
        about: Generate document key.
        args:
            - server-key:
                long: server-key
                value_name: SERVER_KEY
                help: Hex-encoded server public key.
                takes_value: true
                required: true
            - author-key:
                long: author-key
                value_name: AUTHOR_KEY
                help: Hex-encoded author public key.
                takes_value: true
                required: true
    - encrypt-message:
        about: Encrypt message using encrypted document key.
        args:
            - encrypted-document-key:
                long: encrypted-document-key
                value_name: ENCRYPTED_DOCUMENT_KEY
                help: Hex-encoded encrypted document key.
                takes_value: true
                required: true
            - author-secret:
                long: author-secret
                value_name: AUTHOR_SECRET
                help: Hex-encoded author secret key.
                takes_value: true
                required: true
            - message:
                long: message
                value_name: MESSAGE
                help: Arbitrary message string.
                takes_value: true
                required: true
    - decrypt-message:
        about: Decrypt message using encrypted document key.
        args:
            - encrypted-document-key:
                long: encrypted-document-key
                value_name: ENCRYPTED_DOCUMENT_KEY
                help: Hex-encoded encrypted document key.
                takes_value: true
                required: true
            - requester-secret:
                long: requester-secret
                value_name: REQUESTER_SECRET
                help: Hex-encoded requester secret key.
                takes_value: true
                required: true
            - encrypted-message:
                long: encrypted-message
                value_name: ENCRYPTED_MESSAGE
                help: Hex-encoded encrypted message.
                takes_value: true
                required: true
    - shadow-decrypt-message:
        about: Decrypt message using document key shadow.
        args:
            - common-point:
                long: common-point
                value_name: COMMON_POINT
                help: Hex-encoded common point that has been used during document key generation.
                takes_value: true
                required: true
            - decrypted-secret:
                long: decrypted-secret
                value_name: DECRYPTED_SECRET
                help: Hex-encoded partially decrypted document key.
                takes_value: true
                required: true
            - decrypt-shadows:
                long: decrypt-shadows
                value_name: DECRYPT_SHADOW
                help: Hex-encoded decryption shadows.
                takes_value: true
                required: true
                multiple: true
                min_values: 1
            - requester-secret:
                long: requester-secret
                value_name: REQUESTER_SECRET
                help: Hex-encoded requester secret key.
                takes_value: true
                required: true
            - encrypted-message:
                long: encrypted-message
                value_name: ENCRYPTED_MESSAGE
                help: Hex-encoded encrypted message.
                takes_value: true
                required: true